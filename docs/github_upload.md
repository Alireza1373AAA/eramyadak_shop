# راهنمای انتشار پروژه در مخزن جدید گیت‌هاب

این راهنما توضیح می‌دهد چگونه پروژه «ارم یدک شاپ» را در یک مخزن تازه روی GitHub قرار دهید.

## پیش‌نیازها
- داشتن حساب GitHub و وارد شدن به آن.
- نصب بودن Git روی سیستم.
- دسترسی به ترمینال (Command Prompt، PowerShell یا ترمینال VS Code).

## روش سریع: استفاده از اسکریپت خودکار
برای جلوگیری از ورود دستی دستورها، می‌توانید اسکریپت `scripts/upload_to_github.sh` را اجرا کنید. این اسکریپت مخزن جدید را می‌سازد، ریموت را تنظیم می‌کند و شاخهٔ فعلی را push می‌کند. در صورت نیاز می‌تواند توکن را به‌صورت تعاملی دریافت کرده و تغییرات ذخیره‌نشده را commit کند.

1. یک Personal Access Token با سطح دسترسی `repo` در GitHub بسازید. می‌توانید آن را به یکی از روش‌های زیر در اختیار اسکریپت بگذارید یا هنگام اجرا به‌صورت تعاملی وارد کنید:
   - متغیر محیطی:
     ```bash
     export GITHUB_TOKEN=ghp_xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
     ```
   - گزینهٔ `--token` در زمان اجرا:
     ```bash
     ./scripts/upload_to_github.sh eramyadak-shop --token ghp_xxx
     ```
   - گزینهٔ `--token-file` اگر توکن را در فایل امنی نگه می‌دارید:
     ```bash
     ./scripts/upload_to_github.sh eramyadak-shop --token-file ~/.config/github/token
     ```
2. در پوشهٔ پروژه دستور زیر را اجرا کنید (نام مخزن دلخواه است):
   ```bash
   ./scripts/upload_to_github.sh eramyadak-shop --visibility public
   ```
3. در صورت تمایل می‌توانید گزینه‌های زیر را اضافه کنید:
   - `--branch main` برای push شاخه‌ای غیر از شاخهٔ فعلی.
   - `--remote github` اگر می‌خواهید ریموت با نام دیگری ذخیره شود.
   - `--org MyCompany` برای ساخت مخزن داخل یک سازمان.
   - `--token-file secrets.txt` یا `--token ghp_xxx` درصورتی‌که نمی‌خواهید متغیر محیطی بسازید.
   - `--description "Erm Yadak Shop"` برای ثبت توضیح در صفحهٔ مخزن.
   - `--auto-commit --commit-message "chore: sync from VS Code"` تا تغییرات ذخیره‌نشده همزمان stage و commit شوند.
   - `--login USERNAME` اگر قصد دارید با کاربری متفاوت از مالک مخزن push انجام دهید.

> اگر توکن را از هیچ‌کدام از روش‌های بالا تأمین نکنید، اسکریپت هنگام اجرا آن را (به صورت مخفی) از شما می‌پرسد.
> پس از اتمام اجرا، آدرس مخزن در خروجی چاپ می‌شود. اسکریپت از متغیر `GITHUB_TOKEN` به‌صورت موقت جهت احراز هویت استفاده می‌کند و آن را داخل فایل‌ها ذخیره نمی‌کند.

### رفع خطاهای متداول در اسکریپت
- **پیام «current branch has no commits to push»**: شاخهٔ فعلی هنوز commit ندارد، بنابراین چیزی برای push کردن وجود ندارد. یا ابتدا به‌صورت دستی `git add` و `git commit` انجام دهید، یا اسکریپت را با گزینهٔ `--auto-commit` اجرا کنید تا تغییرات موجود به‌طور خودکار commit شوند.
- **خطای احراز هویت (Authentication failed)**: مطمئن شوید توکنی که وارد کرده‌اید معتبر و دارای سطح دسترسی `repo` است. در صورت فعال‌بودن احراز هویت دومرحله‌ای، فقط Personal Access Token قابل قبول است و رمزعبور حساب کاربری کار نمی‌کند.
- **وجود فایل‌های جدید پس از push نشدن به GitHub**: بررسی کنید که همهٔ فایل‌های موردنظر commit شده باشند. دستور `git status` باید خروجی «nothing to commit, working tree clean» نمایش دهد. در غیر این صورت تغییرات را commit کرده یا مجدداً با گزینهٔ `--auto-commit` اجرا کنید.


## ۱. ساخت مخزن جدید در GitHub
1. به آدرس [https://github.com/new](https://github.com/new) بروید.
2. یک **Repository name** دلخواه (مثلاً `eramyadak-shop`) وارد کنید.
3. در صورت تمایل توضیحات (Description) اضافه کنید.
4. گزینه **Private** یا **Public** را بر اساس نیاز خود انتخاب کنید.
5. سایر گزینه‌ها (README، .gitignore، license) را تیک نزنید تا مخزن خالی ایجاد شود.
6. روی **Create repository** کلیک کنید.

پس از ساخت مخزن، GitHub دستورهایی برای push اولیه نمایش می‌دهد. آن‌ها را در بخش‌های بعدی استفاده می‌کنیم.

## ۲. تنظیم ریموت جدید روی سیستم خود
در پوشهٔ پروژه، ترمینال را باز کنید و دستورات زیر را اجرا کنید. آدرس مخزن را با URL مخزن تازه جایگزین کنید:

```bash
git remote remove origin   # اگر ریموت فعلی لازم نیست
# یا می‌توانید نام دیگری برای ریموت جدید بگذارید (مثلاً github)

git remote add origin https://github.com/USERNAME/REPO.git
```

> **نکته:** اگر پروژه قبلاً ریموتی دارد که نمی‌خواهید حذف شود، می‌توانید ریموت تازه را با نام دیگری مثل `github` اضافه کنید و به‌جای `origin` از همان نام استفاده کنید.

## ۳. پوش کردن کدها به مخزن تازه
ابتدا مطمئن شوید همهٔ تغییرات مورد نظر commit شده‌اند. سپس فرمان‌های زیر را اجرا کنید:

```bash
git push -u origin main
```

اگر شاخهٔ اصلی شما نام دیگری دارد (مثلاً `master`)، آن را جایگزین کنید. گزینهٔ `-u` اتصال شاخهٔ محلی و ریموت را تنظیم می‌کند تا دفعات بعد فقط `git push` کافی باشد.

در صورت نیاز به احراز هویت، GitHub از شما نام کاربری و Personal Access Token (به‌جای پسورد) درخواست می‌کند.

## ۴. بررسی مخزن روی GitHub
پس از پایان push، صفحهٔ مخزن را بازخوانی کنید. فایل‌ها و تاریخچهٔ commit باید دیده شوند. در صورت تمایل می‌توانید:
- بخش **Settings → Collaborators** را برای افزودن همکاران تنظیم کنید.
- توضیحات README را ویرایش کنید.
- شاخه‌های اضافی یا GitHub Actions را اضافه کنید.

## ۵. انتشار نسخه یا ساخت Release (اختیاری)
اگر می‌خواهید نسخهٔ مشخصی منتشر کنید:
1. در ترمینال تگ بسازید:
   ```bash
   git tag -a v1.0.0 -m "اولین انتشار"
   git push origin v1.0.0
   ```
2. در صفحهٔ Releases روی GitHub یک Release جدید از روی همین تگ بسازید.

## ۶. نکات تکمیلی
- اگر در آینده نیاز به تغییر آدرس ریموت داشتید از `git remote set-url` استفاده کنید.
- برای مدیریت چند ریموت (مثلاً GitLab و GitHub) کافی است هر کدام را با نام متفاوت اضافه کنید و زمان push نام آن را مشخص نمایید.
- در صورت استفاده از SSH، به‌جای آدرس HTTPS از آدرس `git@github.com:USERNAME/REPO.git` استفاده کنید و مطمئن شوید کلید SSH در GitHub ثبت شده است.

با انجام مراحل بالا پروژه روی مخزن جدید GitHub در دسترس خواهد بود.
